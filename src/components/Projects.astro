---
interface Project {
  name: string;
  description?: string;
  highlights?: string[];
  keywords?: string[];
  startDate?: string;
  endDate?: string;
  url?: string;
  roles?: string[];
  entity?: string;
  type?: string;
}

interface Props {
  projects: Project[];
}

const { projects } = Astro.props;

const formatDate = (dateStr?: string) => {
  if (!dateStr) return '';
  const date = new Date(dateStr);
  return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
};
---

<section class="py-10 px-6">
  <div class="max-w-4xl mx-auto">
    <h2 class="text-2xl font-semibold text-foreground mb-6 flex items-center gap-2">
      <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>
        <path d="M12 10v6"/>
        <path d="m9 13 3-3 3 3"/>
      </svg>
      Selected Projects
    </h2>

    <div class="grid gap-4 md:grid-cols-2">
      {projects.map((project) => (
        <div class="border border-border bg-card p-5 shadow-sm">
          <div class="flex items-start justify-between gap-2">
            <div>
              <h3 class="font-semibold text-card-foreground">
                {project.url ? (
                  <a href={project.url} target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors inline-flex items-center gap-1">
                    {project.name}
                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                      <polyline points="15 3 21 3 21 9"/>
                      <line x1="10" x2="21" y1="14" y2="3"/>
                    </svg>
                  </a>
                ) : (
                  project.name
                )}
              </h3>
              {project.entity && (
                <p class="text-sm text-muted-foreground">{project.entity}</p>
              )}
            </div>
            {project.startDate && (
              <span class="inline-flex items-center bg-secondary px-2 py-0.5 text-xs font-medium text-secondary-foreground whitespace-nowrap">
                {formatDate(project.startDate)} â€” {project.endDate ? formatDate(project.endDate) : 'Present'}
              </span>
            )}
          </div>

          {project.description && (
            <p class="text-sm text-muted-foreground mt-3">{project.description}</p>
          )}

          {project.roles && project.roles.length > 0 && (
            <div class="flex flex-wrap gap-1.5 mt-3">
              {project.roles.map((role) => (
                <span class="text-xs bg-primary/10 text-primary px-2 py-0.5 font-medium">
                  {role}
                </span>
              ))}
            </div>
          )}

          {project.highlights && project.highlights.length > 0 && (
            <ul class="mt-3 space-y-1">
              {project.highlights.map((highlight) => (
                <li class="text-xs text-muted-foreground flex items-start gap-1.5">
                  <svg class="w-3.5 h-3.5 text-primary mt-0.5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 6 9 17l-5-5"/>
                  </svg>
                  <span>{highlight}</span>
                </li>
              ))}
            </ul>
          )}

          {project.keywords && project.keywords.length > 0 && (
            <div class="flex flex-wrap gap-1 mt-3 pt-3 border-t border-border">
              {project.keywords.map((keyword) => (
                <span class="text-xs bg-secondary text-secondary-foreground px-2 py-0.5">
                  {keyword}
                </span>
              ))}
            </div>
          )}
        </div>
      ))}
    </div>
  </div>
</section>
