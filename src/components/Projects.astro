---
interface Project {
  name: string;
  description?: string;
  highlights?: string[];
  keywords?: string[];
  startDate?: string;
  endDate?: string;
  url?: string;
  roles?: string[];
  entity?: string;
  type?: string;
}

interface Props {
  projects: Project[];
}

const { projects } = Astro.props;

const formatDate = (dateStr?: string) => {
  if (!dateStr) return '';
  const date = new Date(dateStr);
  return date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
};
---

<section class="py-8 px-6 bg-slate-50">
  <div class="max-w-4xl mx-auto">
    <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2">
      <svg class="w-6 h-6 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
      </svg>
      Projects
    </h2>

    <div class="grid gap-4 md:grid-cols-2">
      {projects.map((project) => (
        <div class="bg-white rounded-lg p-5 shadow-sm border border-slate-100">
          <div class="flex items-start justify-between gap-2">
            <div>
              <h3 class="font-semibold text-slate-800">
                {project.url ? (
                  <a href={project.url} target="_blank" rel="noopener noreferrer" class="hover:text-slate-600 transition-colors">
                    {project.name}
                  </a>
                ) : (
                  project.name
                )}
              </h3>
              {project.entity && (
                <p class="text-sm text-slate-500">{project.entity}</p>
              )}
            </div>
            {project.startDate && (
              <span class="text-xs text-slate-500 whitespace-nowrap">
                {formatDate(project.startDate)} â€” {project.endDate ? formatDate(project.endDate) : 'Present'}
              </span>
            )}
          </div>

          {project.description && (
            <p class="text-sm text-slate-600 mt-3">{project.description}</p>
          )}

          {project.roles && project.roles.length > 0 && (
            <div class="flex flex-wrap gap-1.5 mt-3">
              {project.roles.map((role) => (
                <span class="text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded border border-blue-100">
                  {role}
                </span>
              ))}
            </div>
          )}

          {project.highlights && project.highlights.length > 0 && (
            <ul class="mt-3 space-y-1">
              {project.highlights.map((highlight) => (
                <li class="text-xs text-slate-600 flex items-start gap-1.5">
                  <svg class="w-3 h-3 text-slate-400 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                  </svg>
                  <span>{highlight}</span>
                </li>
              ))}
            </ul>
          )}

          {project.keywords && project.keywords.length > 0 && (
            <div class="flex flex-wrap gap-1 mt-3 pt-3 border-t border-slate-100">
              {project.keywords.map((keyword) => (
                <span class="text-xs bg-slate-100 text-slate-600 px-2 py-0.5 rounded">
                  {keyword}
                </span>
              ))}
            </div>
          )}
        </div>
      ))}
    </div>
  </div>
</section>
